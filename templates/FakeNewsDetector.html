<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CredibilityScan Detector</title>
    
    <link rel="stylesheet" href="../static/css/FakeNewsDetectorStyle.CSS" />
    
    <link href="https://fonts.googleapis.com/css2?family=Geo:ital@0;1&family=Oswald:wght@200..700&family=Rubik:ital,wght@0,300;1,300&display=swap" rel="stylesheet">
    
    <style>
        /* === INTERNAL STYLES (Helpers for dynamic content) === */
        
        /* 1. LIME Highlight Classes (Used by Python to color text) */
        .lime-good {
            background-color: #dcfce7; /* Light Green */
            color: #166534;
            border-radius: 3px;
            padding: 1px 2px;
            font-weight: bold;
        }
        .lime-bad {
            background-color: #fee2e2; /* Light Red */
            color: #991b1b;
            border-radius: 3px;
            padding: 1px 2px;
            font-weight: bold;
        }

        /* 2. States for the Result Area */
        #results-area {
            display: none; /* Hidden by default until analysis finishes */
        }
        .placeholder-state {
            text-align: center;
            color: #6b7280;
            padding: 40px;
        }
        
        /* 3. Helper for Transcription Box (Video) */
        .transcription-box {
            max-height: 150px; 
            overflow-y: auto; 
            background: #f8f9fa; 
            padding: 12px; 
            border-radius: 8px;
            border: 1px solid #e9ecef;
            font-family: monospace;
        }
    </style>
</head>
<body>

    <header class="navbar">
        <div class="logo">
            <h1>CredibilityScan</h1>
        </div>
        <input type="checkbox" id="nav-toggle" class="nav-toggle">
        <label for="nav-toggle" class="nav-toggle-label">
            <span></span>
        </label>
        <nav class="nav-menu">
            <div class="bordnav">
                <a href="/">Home</a>
                <a href="detector">Detector</a>
                <a href="about">About Us</a>
            </div>
        </nav>
    </header>

    <div class="detector-container">
        <div class="main-content-wrapper">

            <div class="input-column">
                
                <div class="input-tab-bar" role="tablist" aria-label="Input mode tabs">
                    <button id="tab-text" class="tab tab-active" data-mode="text" type="button">Text</button>
                    <button id="tab-video" class="tab" data-mode="video" type="button">Video</button>
                </div>

                <form id="analyzeForm" class="form">
                    
                    <div class="mode mode-text">
                        <textarea id="userInput" name="news_text" class="detector-textarea" 
                            placeholder="Paste your news article text here to analyze..." required></textarea>
                    </div>
                
                    <div class="mode mode-video" style="display:none;">
                        <label for="video-url" class="detector-label">Video URL</label>
                        <input id="videoUrlInput" name="video_url" type="url" class="detector-textarea" 
                            placeholder="https://www.youtube.com/watch?v=..." />
                    </div>

                    <button type="submit" class="detector-btn" style="margin-top: 20px;">Analyze</button>
                    
                    <div id="loading" style="display:none; text-align:center; margin-top:10px;">
                        <span>Analyzing... Please wait.</span>
                    </div>

                </form>
            </div> 

            <div class="results-column">

                <button type="button" class="history-trigger-btn" id="history-trigger-btn">
                    View Recent Analysis
                </button>

                <div id="results-placeholder" class="placeholder-state">
                    <h3>Ready to Scan</h3>
                    <p>Enter your text or video URL on the left and click "Analyze" to see the credibility assessment.</p>
                </div>

                <div id="results-area">
                    
                    <div class="results-content">
                        <h2 style="font-family: 'Rubik', sans-serif; font-weight: 600; margin-top: 0;">Analysis Result</h2>

                        <div class="score-box" style="padding: 24px; background-color: #f8f9fa; border-radius: 8px; margin-bottom: 20px;">
                            <h3 id="verdict-label" style="font-size: 2.25rem; margin-bottom: 8px; color: #333;">--</h3>
                        </div>

                        <div class="classification" style="border-left: 5px solid #ccc; background-color: #f0f0f0; padding: 10px;">
                            Most Likely <strong id="classification-text">--</strong><br>
                            Confidence: <span id="confidence-score">0%</span>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <h3>Text Analysis Highlights</h3>
                        
                        <div id="result-container" class="detector-textarea" style="overflow-y: auto; line-height: 1.6; height: auto; min-height: 200px; background: white; border: 1px solid #ddd;">
                            </div>
                        
                        <div class="legend-box" style="margin-top: 10px; font-size: 0.9rem;">
                            <div style="display:flex; align-items:center; gap: 8px;">
                                <div class="lime-bad" style="width: 20px; height: 20px; display:inline-block;"></div>
                                <span>= Words often associated with Fake News</span>
                            </div>
                            <div style="display:flex; align-items:center; gap: 8px; margin-top: 5px;">
                                <div class="lime-good" style="width: 20px; height: 20px; display:inline-block;"></div>
                                <span>= Words often associated with Real News</span>
                            </div>
                        </div>
                    </div>

                    <div class="sources" style="margin-top: 20px;">
                        <h3>Supporting Sources</h3>
                        <div id="sources-list">
                            </div>
                    </div>

                </div> </div> 
        </div> 
    </div> 

    <div class="modal-overlay" id="history-modal-overlay">
        <div class="modal-content">
            <div class="history-container">
                <div class="modal-header" style="flex-direction: column; align-items: stretch; gap: 10px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h3>Recent Analysis</h3>
                        <button class="modal-close-btn" id="history-close-btn">&times;</button>
                    </div>
                    
                    <div style="display: flex; gap: 8px;">
                        <select id="history-filter-select" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; background: #f8f9fa; cursor: pointer; font-family: 'Rubik', sans-serif;">
                            <option value="all">All History</option>
                            <option value="saved">‚≠ê Saved / Favorites</option>
                            <option value="real">Verdicts: Real / Credible</option>
                            <option value="fake">Verdicts: Fake / Low Credibility</option>
                            <option value="uncertain">Verdicts: Uncertain</option>
                            <option value="text">Type: Text Articles</option>
                            <option value="video">Type: Videos</option>
                        </select>

                        <input type="text" id="history-search-input" placeholder="Search keywords..." 
                            style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: 'Rubik', sans-serif;">
                    </div>
                </div>
                
                <div id="history-list" class="history-list">
                    <p class="history-empty">No history yet.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
    (function(){
        // --- TAB SWITCHING LOGIC ---
        const tabs = document.querySelectorAll('.tab');
        const textMode = document.querySelector('.mode-text');
        const videoMode = document.querySelector('.mode-video');
        const textInput = document.getElementById('userInput');
        const videoInput = document.getElementById('videoUrlInput');

        function setMode(mode){
            // Highlight active tab
            tabs.forEach(t => {
                t.classList.toggle('tab-active', t.dataset.mode === mode);
            });
            
            // Show/Hide Inputs
            if(mode === 'video'){
                textMode.style.display = 'none';
                videoMode.style.display = 'block';
                // Toggle 'required' to prevent form error on hidden fields
                if(textInput) textInput.required = false;
                if(videoInput) videoInput.required = true;
            } else {
                textMode.style.display = 'block';
                videoMode.style.display = 'none';
                if(textInput) textInput.required = true;
                if(videoInput) videoInput.required = false;
            }
        }

        // Attach Click Events
        tabs.forEach(t => t.addEventListener('click', () => setMode(t.dataset.mode)));

        // --- MODAL TOGGLE LOGIC ---
        const modal = document.getElementById('history-modal-overlay');
        const btn = document.getElementById('history-trigger-btn');
        const close = document.getElementById('history-close-btn');

        if(btn) btn.onclick = () => modal.classList.add('modal-active');
        if(close) close.onclick = () => modal.classList.remove('modal-active');
        
        // Close when clicking outside the box
        window.onclick = (e) => {
            if (e.target == modal) modal.classList.remove('modal-active');
        }
    })();
    </script>

    <script src="/static/js/main.js"></script>

</body>
</html>